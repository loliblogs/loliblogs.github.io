import"./compat.module.eoMXoyo6.js";import{y as e}from"./hooks.module.7OROTjBQ.js";import"./preact.module.C1TiR6ni.js";
/*! medium-zoom-next 2.0.1 | MIT License | https://github.com/SpasiboKojima/medium-zoom-next */const t=e=>"IMG"===e.tagName,o=e=>"object"==typeof e&&"nodeType"in e&&1===e.nodeType,n=e=>{try{return Array.isArray(e)?e.filter(t):(e=>Object.prototype.isPrototypeOf.call(NodeList.prototype,e))(e)?Array.from(e).filter(t):"string"==typeof e?Array.from(document.querySelectorAll(e)).filter(t):o(e)?[e].filter(t):[]}catch{throw new TypeError("The provided selector is invalid.\nExpects a CSS selector, a Node element, a NodeList or an array.\nSee: https://github.com/francoischalifour/medium-zoom")}},i=(e,t)=>{const o={bubbles:!1,cancelable:!1,detail:void 0,...t};return new CustomEvent(e,o)},r=e=>{if(!e)return null;const t=o(e)?e:document.querySelector(e);if(!t||"TEMPLATE"!==t.tagName)throw new Error("The specified template option is not a <template> element.");return t},a=(e,t={})=>{const d=new AbortController,l=()=>{z=!1},m=(...e)=>{const t=e.reduce((e,t)=>e.concat(n(t)),[]);return t.filter(e=>-1===h.indexOf(e)).forEach(e=>{h.push(e),e.classList.add("medium-zoom-image"),e.addEventListener("click",()=>g({target:e}),{signal:d.signal})}),f.forEach(({type:e,listener:o,options:n})=>{t.forEach(t=>{t.addEventListener(e,o,n)})}),b},s=()=>{let e,t,n={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0};if(E.container)if(E.container instanceof Object&&"top"in E.container)n={...n,...E.container},e=n.width-n.left-n.right-2*E.margin,t=n.height-n.top-n.bottom-2*E.margin;else if(E.container instanceof HTMLElement||"string"==typeof E.container){const e=o(E.container)?E.container:document.querySelector(E.container);if(e){const{width:t,height:o,left:i,top:r}=e.getBoundingClientRect();n.width=t,n.height=o,n.left=i,n.top=r}}e??=n.width-2*E.margin,t??=n.height-2*E.margin;const i=w.zoomed||w.original;if(!i||!w.zoomed)return;const r=".svg"===((a=i).currentSrc||a.src).slice(-4).toLowerCase();var a;const d=r?e:i.naturalWidth||e,l=r?t:i.naturalHeight||t,{top:m,left:s,width:c,height:u}=i.getBoundingClientRect(),p=Math.min(Math.max(c,d),e)/c,g=Math.min(Math.max(u,l),t)/u,h=Math.min(p,g),f=`scale(${h}) translate(${((e-c)/2-s+E.margin+n.left)/h}px, ${((t-u)/2-m+E.margin+n.top)/h}px) translateZ(0)`;w.zoomed.style.transform=f},c=(e,t={})=>new Promise(o=>{const n=(e=>{const{top:t,left:o,width:n,height:i}=e.getBoundingClientRect(),r=e.cloneNode(),a=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop||0,d=window.scrollX||document.documentElement.scrollLeft||document.body.scrollLeft||0;return r.removeAttribute("id"),r.style.position="absolute",r.style.top=`${t+a}px`,r.style.left=`${o+d}px`,r.style.width=`${n}px`,r.style.height=`${i}px`,r.style.transform="",r})(e);"PICTURE"===e.parentElement?.tagName&&e.currentSrc&&(n.src=e.currentSrc),t.isChange?n.classList.add("medium-zoom-image--opened","medium-zoom-image--change"):n.classList.add("medium-zoom-image--opened");const i=e.getAttribute("data-zoom-src");if(i){const e=n.cloneNode();e.removeAttribute("srcset"),e.removeAttribute("sizes"),e.removeAttribute("loading"),e.src=i,e.onerror=()=>{clearInterval(t),console.warn(`Unable to reach the zoom image target ${e?.src}`),w.zoomed=n,o(n)};const t=setInterval(()=>{e.complete&&(clearInterval(t),o(e))},10)}else if(e.hasAttribute("srcset")){const e=n.cloneNode();e.removeAttribute("sizes"),e.removeAttribute("loading");const t=()=>{e.removeEventListener("load",t),o(e)};e.addEventListener("load",t)}else o(n)}),u=({target:e}={})=>new Promise(t=>{if(e&&-1===h.indexOf(e)||0===h.length)return void t(b);if(w.zoomed)return void t(b);const o=()=>{if(v=!1,!w.zoomed||!w.original)return t(b);w.zoomed.removeEventListener("transitionend",o),w.original.dispatchEvent(i("medium-zoom:opened",{detail:{zoom:b}})),t(b)};e?w.original=e:[w.original]=h,w.original.dispatchEvent(i("medium-zoom:open",{detail:{zoom:b}})),y=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop||0,v=!0,document.body.appendChild(C),E.template&&(w.template=document.createElement("div"),w.template.appendChild(E.template.content.cloneNode(!0)),document.body.appendChild(w.template)),c(w.original,{}).then(e=>{document.body.appendChild(e),e.addEventListener("click",p),e.addEventListener("transitionend",o),w.original?.classList.add("medium-zoom-image--hidden"),window.requestAnimationFrame(()=>{document.body.classList.add("medium-zoom--opened")}),w.zoomed=e,s()})}),p=()=>new Promise(e=>{if(v||!w.original||!w.zoomed)return void e(b);const t=()=>{if(!w.original||!w.zoomed)return e(b);w.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(w.zoomed),document.body.removeChild(C),w.zoomed.classList.remove("medium-zoom-image--opened"),w.template&&document.body.removeChild(w.template),v=!1,w.zoomed.removeEventListener("transitionend",t),w.original.dispatchEvent(i("medium-zoom:closed",{detail:{zoom:b}})),w.original=null,w.zoomed=null,w.template=null,e(b)};v=!0,document.body.classList.remove("medium-zoom--opened"),w.zoomed.classList.remove("medium-zoom-image--change"),w.zoomed.style.transform="",w.template&&(w.template.style.transition="opacity 150ms",w.template.style.opacity="0"),w.original.dispatchEvent(i("medium-zoom:close",{detail:{zoom:b}})),w.zoomed.addEventListener("transitionend",t)}),g=({target:e}={})=>w.original?p():u({target:e});let h=[],f=[],v=!1,z=!1,y=0,E={margin:0,scrollOffset:40,container:null,template:null};const w={original:null,zoomed:null,template:null},b={open:u,change:({target:e})=>new Promise(t=>{if(e&&-1===h.indexOf(e)||0===h.length)return void t(b);if(v||!w.original||!w.zoomed)return void t(b);w.original.classList.remove("medium-zoom-image--hidden"),e?w.original=e:[w.original]=h,y=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,v=!0,c(w.original,{isChange:!0}).then(e=>{e.addEventListener("click",p),document.body.appendChild(e),w.zoomed&&document.body.removeChild(w.zoomed),w.zoomed=e,w.original?.classList.add("medium-zoom-image--hidden"),s(),w.original?.dispatchEvent(i("medium-zoom:changed",{detail:{zoom:b}})),v=!1,t(b)})}),close:p,toggle:g,update:(e={})=>{const t=e;return e.container&&e.container instanceof Object&&(t.container={...E.container instanceof Object?E.container:{},...e.container}),E={...E,...t,template:r(e.template)},h.forEach(e=>{e.dispatchEvent(i("medium-zoom:update",{detail:{zoom:b}}))}),b},clone:(e={})=>a({...E,...e}),attach:m,detach:(...e)=>{w.zoomed&&p();const t=e.length>0?e.reduce((e,t)=>e.concat(n(t)),[]):h;return t.forEach(e=>{e.classList.remove("medium-zoom-image"),e.dispatchEvent(i("medium-zoom:detach",{detail:{zoom:b}}))}),h=h.filter(e=>-1===t.indexOf(e)),b},on:(e,t,o={})=>(h.forEach(n=>{n.addEventListener(`medium-zoom:${e}`,t,o)}),f.push({type:`medium-zoom:${e}`,listener:t,options:o}),b),off:(e,t,o={})=>(h.forEach(n=>{n.removeEventListener(`medium-zoom:${e}`,t,o)}),f=f.filter(o=>!(o.type===`medium-zoom:${e}`&&o.listener.toString()===t.toString())),b),getOptions:()=>E,getImages:()=>h,getZoomedImage:()=>w.original,destroy:()=>d.abort()};let L;"[object Object]"===Object.prototype.toString.call(e)?L=e:(L=t,(e||"string"==typeof e)&&m(e)),E={...E,...L,template:r(L.template)};const C=(()=>{const e=document.createElement("div");return e.classList.add("medium-zoom-overlay"),e})();return C.addEventListener("click",p),document.addEventListener("keydown",e=>{const t=e.key;"Escape"!==t&&"Esc"!==t&&"Tab"!==t||p()},{signal:d.signal}),window.addEventListener("scroll",()=>{if(v||!w.original)return;const e=window.visualViewport?.scale??1;if(z||e>1)return;const t=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(y-t)>E.scrollOffset&&setTimeout(p,150)},{passive:!0,signal:d.signal}),window.addEventListener("touchstart",e=>{e.touches.length>1&&(z=!0)},{passive:!0,signal:d.signal}),window.addEventListener("touchend",l,{passive:!0,signal:d.signal}),window.addEventListener("touchcancel",l,{passive:!0,signal:d.signal}),window.addEventListener("resize",()=>{const e=window.visualViewport?.scale??1;z||e>1||p()},{passive:!0,signal:d.signal}),b};function d(){return e(()=>{const e=a("#content img"),t=()=>{e.attach("#content img")};return window.addEventListener("content-decrypted",t),()=>{e.detach(),window.removeEventListener("content-decrypted",t)}},[]),null}export{d as default};
//# sourceMappingURL=MediumZoom.BaN2Se_r.js.map
