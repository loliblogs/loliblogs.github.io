{"version":3,"file":"NavigationController.B1rsA8L7.js","sources":["../../src/components/NavigationController.tsx"],"sourcesContent":["import { useEffect } from 'react';\n\nconst NavigationController = () => {\n  useEffect(() => {\n    const controller = new AbortController();\n    const { signal } = controller;\n\n    // 缓存DOM元素\n    const elements = {\n      navMenu: document.getElementById('nav-menu'),\n      aside: document.getElementById('aside'),\n      asideMask: document.getElementById('aside-mask'),\n    };\n\n    // 统一的toggle处理\n    const toggleClass = (element: Element | null, className: string, force?: boolean) => {\n      element?.classList.toggle(className, force);\n    };\n\n    // 高亮当前页面\n    const highlightCurrentNav = () => {\n      const currentPath = window.location.pathname;\n\n      document.querySelectorAll('[data-nav-item]').forEach((item) => {\n        const navPath = item.getAttribute('data-path');\n        const recursive = item.getAttribute('data-recursive') !== 'false';  // 默认true，false表示精确匹配\n        if (!navPath) return;\n\n        // 根据recursive决定匹配逻辑 - 直接比较，不做任何转换\n        let isActive: boolean;\n        if (recursive) {\n          // 递归匹配：当前路径是导航路径或其子路径\n          // 首页特殊处理，否则任何界面都会被高亮\n          isActive = currentPath === navPath\n            || (navPath === '/' ? false : currentPath.startsWith(navPath + '/'));\n        } else {\n          // 精确匹配：当前路径必须完全等于导航路径\n          isActive = currentPath === navPath;\n        }\n\n        if (isActive) {\n          // 统一给nav-item添加激活背景\n          item.classList.add('bg-active');\n        }\n      });\n    };\n\n    // 执行高亮\n    highlightCurrentNav();\n\n    // 菜单控制\n    document.getElementById('open-menus')?.addEventListener(\n      'click',\n      (e) => {\n        e.stopPropagation();\n        toggleClass(elements.navMenu, 'show');\n      },\n      { signal },\n    );\n\n    // 侧边栏控制\n    document.getElementById('open-panel')?.addEventListener(\n      'click',\n      (e) => {\n        e.stopPropagation();\n        toggleClass(elements.aside, 'aside-panel-show');\n        toggleClass(elements.asideMask, 'aside-mask-visible');\n      },\n      { signal },\n    );\n\n    // 点击外部关闭\n    document.addEventListener(\n      'click',\n      (e) => {\n        const nav = document.getElementById('nav');\n        if (nav && !nav.contains(e.target as Node)) {\n          toggleClass(elements.navMenu, 'show', false);\n        }\n      },\n      { signal },\n    );\n\n    // 移动端菜单项点击后关闭\n    elements.navMenu?.querySelectorAll('[data-nav-item]').forEach((item) => {\n      item.addEventListener(\n        'click',\n        () => {\n          if (window.innerWidth < 1024) {\n            toggleClass(elements.navMenu, 'show', false);\n          }\n        },\n        { signal },\n      );\n    });\n\n    // 遮罩点击关闭\n    elements.asideMask?.addEventListener(\n      'click',\n      () => {\n        toggleClass(elements.aside, 'aside-panel-show', false);\n        toggleClass(elements.asideMask, 'aside-mask-visible', false);\n      },\n      { signal },\n    );\n\n    return () => {\n      controller.abort();\n    };\n  }, []);\n\n  return null;\n};\n\nexport default NavigationController;\n"],"names":["NavigationController","useEffect","controller","AbortController","signal","elements","navMenu","document","getElementById","aside","asideMask","toggleClass","element","className","force","classList","toggle","highlightCurrentNav","currentPath","window","location","pathname","querySelectorAll","forEach","item","navPath","getAttribute","recursive","isActive","startsWith","add","addEventListener","e","stopPropagation","nav","contains","target","innerWidth","abort"],"mappings":"uHAEA,MAAMA,EAAuBA,KAC3BC,EAAU,KACR,MAAMC,EAAa,IAAIC,iBACjBC,OAAEA,GAAWF,EAGbG,EAAW,CACfC,QAASC,SAASC,eAAe,YACjCC,MAAOF,SAASC,eAAe,SAC/BE,UAAWH,SAASC,eAAe,eAI/BG,EAAcA,CAACC,EAAyBC,EAAmBC,KAC/DF,GAASG,UAAUC,OAAOH,EAAWC,IA0FvC,MAtF4BG,MAC1B,MAAMC,EAAcC,OAAOC,SAASC,SAEpCd,SAASe,iBAAiB,mBAAmBC,QAASC,IACpD,MAAMC,EAAUD,EAAKE,aAAa,aAC5BC,EAAoD,UAAxCH,EAAKE,aAAa,kBACpC,IAAKD,EAAS,OAGd,IAAIG,EAIFA,EAHED,EAGST,IAAgBO,GACT,MAAZA,GAA0BP,EAAYW,WAAWJ,EAAU,KAGtDP,IAAgBO,EAGzBG,GAEFJ,EAAKT,UAAUe,IAAI,gBAMzBb,GAGAV,SAASC,eAAe,eAAeuB,iBACrC,QACCC,IACCA,EAAEC,kBACFtB,EAAYN,EAASC,QAAS,SAEhC,CAAEF,WAIJG,SAASC,eAAe,eAAeuB,iBACrC,QACCC,IACCA,EAAEC,kBACFtB,EAAYN,EAASI,MAAO,oBAC5BE,EAAYN,EAASK,UAAW,uBAElC,CAAEN,WAIJG,SAASwB,iBACP,QACCC,IACC,MAAME,EAAM3B,SAASC,eAAe,OAChC0B,IAAQA,EAAIC,SAASH,EAAEI,SACzBzB,EAAYN,EAASC,QAAS,QAAQ,IAG1C,CAAEF,WAIJC,EAASC,SAASgB,iBAAiB,mBAAmBC,QAASC,IAC7DA,EAAKO,iBACH,QACA,KACMZ,OAAOkB,WAAa,MACtB1B,EAAYN,EAASC,QAAS,QAAQ,IAG1C,CAAEF,aAKNC,EAASK,WAAWqB,iBAClB,QACA,KACEpB,EAAYN,EAASI,MAAO,oBAAoB,GAChDE,EAAYN,EAASK,UAAW,sBAAsB,IAExD,CAAEN,WAGG,KACLF,EAAWoC,UAEZ,IAEI"}